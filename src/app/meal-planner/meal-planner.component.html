<div class="px-20 py-10">

  <!--Meal Form for entering calories,meals and user's preference-->
<form [formGroup]="mealform" class="px-20 py-6" (submit)="generateMealPlan()"  >
  <div class="py-4 text-center">
  <h1 class="text-[35px] font-semibold">Stay In Perfect Shape With MealMate</h1>
  
</div>
<div class="grid grid-cols-3 gap-6">

  <div class="field">
    <span><i class="fa-solid fa-cookie-bite"></i></span>
     <input type="number" id="maxCalories" formControlName="TotalCalories" placeholder="Calories"/>
  
  <div *ngIf="(mealform.get('TotalCalories')?.invalid && mealform.get('TotalCalories')?.dirty) || mealform.get('TotalCalories')?.touched">
    <div *ngIf="mealform.get('TotalCalories')?.errors?.['required']" class="text-red-800">Enter Calories</div>
    <div *ngIf="mealform.get('TotalCalories')?.errors?.['min']" class="text-red-800"> Calories can't be less than 1200</div>
  </div>
</div>
<div class="field">
  <span><i class="fa-solid fa-utensils"></i></span>
  <select formControlName="dietaryPreference"> 
    <option value="" disabled selected>Select Preference</option>
    <option value="Soy free">Soy free</option>
    <option value="Dairy free">Dairy free</option>
    <option value="Egg free">Egg free</option>
    <option value="Fish free">Fish free</option>
    <option value="Vegetarian">Vegetarian</option>
    <option value="Vegan">Vegan</option>
    <option value="Halal">Halal</option>
    <option value="Gluten free">Gluten free</option>
    <option value="Kosher">Kosher</option>
    <option value=" Nut free">Nut free</option>
    <option value="Paleo">Paleo</option>
    <option value="Pescetarian">Pescetarian</option>
    <option value="Shellfish free">Shellfish free</option>
  </select> 
  <div
    *ngIf="
      (mealform.get('dietaryPreference')?.invalid &&
        mealform.get('dietaryPreference')?.dirty) ||
      mealform.get('dietaryPreference')?.touched
    "
  >
    <div
      *ngIf="mealform.get('dietaryPreference')?.errors?.['required']"
      class="text-red-800"
    >
      Select Preference
    </div>
  </div>
</div>

<div class="field">
  <span><i class="fa-solid fa-earth-americas"></i></span>
  <select formControlName="Region"> 
    <option value="" disabled selected>Select Region</option>
    <option value="">North America</option>
    <option value="">Europe</option>
    <option value="">Asia</option>
    <option value="">South America</option>
    <option value="">Africa</option>
    <option value="">Oceania</option>
    <option value="">Middle East</option>
    <option value="">Central America</option>
    <option value="">Caribbean</option>
    <option value="">Nordic Countries</option>
  </select> 
  <div
    *ngIf="
      (mealform.get('Region')?.invalid &&
        mealform.get('Region')?.dirty) ||
      mealform.get('Region')?.touched
    "
  >
    <div
      *ngIf="mealform.get('Region')?.errors?.['required']"
      class="text-red-800"
    >
      Select Region
    </div>
  </div>
</div>

<div class="field">
  <span><i class="fa-solid fa-ruler"></i></span>
  <input type="number" id="numberOfMeals" formControlName="numberOfMeals" placeholder="Number of Meals"/>
 
  <div *ngIf="(mealform.get('numberOfMeals')?.invalid && mealform.get('numberOfMeals')?.dirty) ||  mealform.get('numberOfMeals')?.touched">
  <div *ngIf="mealform.get('numberOfMeals')?.errors?.['required']" class="text-red-800">Enter Meals</div>
   <div
      *ngIf="mealform.get('numberOfMeals')?.errors?.['min']"
      class="text-red-800">
      Meals can't be less than 1
    </div>
    <div
      *ngIf="mealform.get('numberOfMeals')?.errors?.['max']"
      class="text-red-800">
      Meals can't be more than 5
    </div>
  </div>
</div>


<div class="field">
  <span><i class="fa-solid fa-cheese"></i></span>
  <input type="number" placeholder="Number of Snacks" formControlName="numberOfSnacks" >
  <div *ngIf="(mealform.get('numberOfSnacks')?.invalid && mealform.get('numberOfSnacks')?.dirty) ||  mealform.get('numberOfSnacks')?.touched">
    <div *ngIf="mealform.get('numberOfSnacks')?.errors?.['required']" class="text-red-800">Enter Snacks</div>
     <div
        *ngIf="mealform.get('numberOfSnacks')?.errors?.['max']"
        class="text-red-800">
        Snacks can't be more than 2
      </div>
    </div>
</div>
</div>
  <button class="p-3 px-5 rounded-lg" (click)="showLoader()">
    Generate Meals
  </button>
</form>

<div *ngIf="isLoading; else loadedContent">
  
  Generating Meals.......
</div>


<!--Meal are displayed here depending on user's preference-->
<ng-template #loadedContent>
<div *ngIf="filteredMeals.length > 0" class="mt-10 flex justify-between items-start gap-10">
  <ul class="w-[60%] flex flex-col">
    <li
      *ngFor="let meal of filteredMeals"
      class="flex p-4 mb-6 gap-5 justify-start meals"
    >
      <img
        [src]="meal.image"
        class="rounded-xl w-[100px] h-[100px] object-cover"
      />
      <div class="flex flex-col text-start">
        <div class="pb-2 flex justify-between">
        <h1 class="pl-2 text-[20px] font-medium">{{ meal.name }}</h1>
         <h3>{{ meal.label }}</h3>
        <h2 class="text-[16px] font-medium">{{ meal.perServing}}</h2>
      </div>
        <table class="w-auto table-auto border-collapse table-inner">
          <thead>
            <tr>
              <th>Calories</th>
              <th>Protein</th>
              <th>Carbs</th>
              <th>Fat</th>
              <th>Sugar</th>
              <th style="padding-right: 50px;">Fibre</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>{{ meal.calories }}</td>
              <td class="text-green-600">{{ meal.protein }}g</td>
              <td class="text-orange-700">{{ meal.carbs }}g</td>
              <td class="text-purple-600">{{ meal.fat }}g</td>
              <td class="text-red-600">{{ meal.sugar }}g</td>
              <td class="text-yellow-600" style="padding-right: 50px;">{{ meal.fiber }}g</td>
            </tr>
          </tbody>
        </table>
      </div>
    </li>
    <li *ngFor="let snack of filteredSnacks" class="flex p-4 mb-6 gap-5 justify-start meals">
      <img
      [src]="snack.image"
      class="rounded-xl w-[100px] h-[100px] object-cover"
    />
    <div class="flex flex-col text-start">
      <div class="pb-2 flex justify-between">
      <h1 class="pl-2 text-[20px] font-medium">{{ snack.name }}</h1>
      <h3>{{snack.label}}</h3>
      <h2 class="text-[16px] font-medium">{{ snack.servingSize}}</h2>
    </div>
      <table class="w-full table-auto border-collapse table-inner">
        <thead>
          <tr>
            <th>Calories</th>
            <th>Protein</th>
            <th>Carbs</th>
            <th>Fat</th>
            <th>Sugar</th>
            <th style="padding-right: 50px;">Fibre</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>{{ snack.calories }}</td>
            <td class="text-green-600">{{ snack.protein }}g</td>
            <td class="text-orange-700">{{ snack.carbs }}g</td>
            <td class="text-purple-600">{{ snack.fat }}g</td>
            <td class="text-red-600">{{ snack.sugar }}g</td>
            <td class="text-yellow-600" style="padding-right: 50px;">{{ snack.fiber }}g</td>
          </tr>
        </tbody>
      </table>
    </div>
    </li>  
  </ul>
  <div class="flex flex-col w-[30%]">
  <h1 class="text-[#000000] text-[1.5rem] font-semibold pb-4">Total Nutrition Value</h1>
  <div class="total-table">
    <div class="Total-vals">
      <h2>Total Calories</h2>
      <span>{{totalCalories}} Kcal</span>
    </div>
    <div class="Total-vals">
      <h2>Total Protein</h2>
      <span>{{totalProtein}} g</span>
    </div>
    <div class="Total-vals">
      <h2>Total Carbs</h2>
      <span>{{totalCarbs}} g</span>
    </div>
    <div class="Total-vals">
      <h2>Total Fat</h2>
      <span>{{totalFat}} g</span>
    </div>
    <div class="Total-vals">
      <h2>Total Sugar</h2>
      <span>{{TotalSugar}} g</span>
    </div>
    <div class="Total-vals">
      <h2>Total Fiber</h2>
      <span>{{TotalFiber}} g</span>
    </div>
  
  </div>
</div>
</div>
</ng-template>





</div>